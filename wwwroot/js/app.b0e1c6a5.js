(function(t){function e(e){for(var a,o,s=e[0],c=e[1],d=e[2],u=0,p=[];u<s.length;u++)o=s[u],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&p.push(i[o][0]),i[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);l&&l(e);while(p.length)p.shift()();return r.push.apply(r,d||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],a=!0,s=1;s<n.length;s++){var c=n[s];0!==i[c]&&(a=!1)}a&&(r.splice(e--,1),t=o(o.s=n[0]))}return t}var a={},i={app:0},r=[];function o(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=a,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(n,a,function(e){return t[e]}.bind(null,a));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var d=0;d<s.length;d++)e(s[d]);var l=c;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0417":function(t,e,n){"use strict";var a=n("639d"),i=n.n(a);i.a},"56d7":function(t,e,n){"use strict";n.r(e),n.d(e,"openMap",(function(){return ot})),n.d(e,"mainObj",(function(){return lt})),n.d(e,"openIDs",(function(){return st})),n.d(e,"prodaction",(function(){return at})),n.d(e,"baseUrl",(function(){return it}));n("4160"),n("caad"),n("4ec9"),n("a9e3"),n("b680"),n("d3b7"),n("ac1f"),n("25f0"),n("3ca3"),n("466d"),n("5319"),n("159b"),n("ddb0"),n("96cf");var a=n("1da1"),i=(n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("2b0e")),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("a",{ref:"openFileLink",attrs:{target:"_blanck",hidden:""}}),n("v-dialog",{attrs:{persistent:""},model:{value:t.mainObj.openAlert,callback:function(e){t.$set(t.mainObj,"openAlert",e)},expression:"mainObj.openAlert"}},[n("v-card",[n("v-card-title",[t._v(t._s(t.mainObj.alertTitle))]),n("v-card-text",[t._v(t._s(t.mainObj.alertText))]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(e){return t.handleClose()}}},[t._v("ОК")]),t.mainObj.alertConfirm?n("v-btn",{attrs:{color:"red darken-1",text:""},on:{click:function(e){t.mainObj.openAlert=!1}}},[t._v("Отмена")]):t._e()],1)],1)],1),n("v-navigation-drawer",{attrs:{color:"primary",dark:"",app:"",width:"220",left:""},model:{value:t.mainObj.drawer,callback:function(e){t.$set(t.mainObj,"drawer",e)},expression:"mainObj.drawer"}},[t.loading?n("p",[t._v("Загрузка...")]):n("v-treeview",{attrs:{items:t.treejson,hoverable:t.hoverable,"open-on-click":t.openOnClick,dense:""},scopedSlots:t._u([{key:"label",fn:function(e){var a=e.item;return[n("div",{on:{click:function(e){return t.handleselect(a)}}},[t._v(t._s(a.text))])]}}])})],1),t._l(t.openIDs,(function(t){return[[n("uni-comp",{key:t,attrs:{id:t}})]]}))],2)},o=[],s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{"background-color":"#84FFFF",height:"100%"},attrs:{hidden:!t.visible}},[n("div",{staticStyle:{"background-color":"white","text-align":"center",position:"absolute",left:"0px",bottom:"0px",width:"100%","font-size":"11px"}},[t._v(' ООО "СТЭК" © 2022 ')]),n("v-app-bar",{attrs:{app:""}},[n("v-app-bar-nav-icon",{on:{click:function(e){t.mainObj.drawer=!t.mainObj.drawer}}}),n("v-toolbar-title",[t._v("Рабочее место оператора НСИ")]),n("v-spacer"),t.mainObj.testApi?n("v-icon",{attrs:{title:"API НСИ доступно",color:"green darken-1"}},[t._v("mdi-wifi")]):t._e(),t.mainObj.testApi?t._e():n("v-icon",{attrs:{title:"API НСИ недоступно",color:"red darken-1"}},[t._v("mdi-wifi-off")])],1),n("v-main",[n("div",{style:{height:t.gridHeight+"px"}},[t.loading?t._e():n("v-card",{staticClass:"mx-auto rounded-xl",staticStyle:{position:"absolute",left:"70px",top:"50px",width:"320px",height:"200px"},attrs:{tile:"",flat:""}},[n("v-list",{attrs:{dense:""}},[n("v-list-item-group",t._l(t.items,(function(e){return n("v-list-item",{key:e.id,attrs:{dense:""},on:{click:function(n){return t.open(e)}}},[n("v-list-item-content",[n("v-list-item-title",{staticClass:"subtitle-2"},[t._v(t._s(e.text))])],1)],1)})),1)],1)],1),t.loading?t._e():n("v-card",{staticClass:"mx-auto rounded-xl",staticStyle:{position:"absolute",right:"70px",bottom:"70px",width:"320px",height:"200px"},attrs:{tile:"",flat:""}},[n("v-list",{attrs:{dense:""}},[n("v-list-item-group",t._l(t.items2,(function(e){return n("v-list-item",{key:e.id,attrs:{dense:""},on:{click:function(n){return t.open(e)}}},[n("v-list-item-content",[n("v-list-item-title",{staticClass:"subtitle-2"},[t._v(t._s(e.text))])],1)],1)})),1)],1)],1)],1)])],1)},c=[],d=n("f397"),l={name:"Comp1",data:function(){return{mainObj:lt,loading:!0,gridHeight:lt.gridHeight(),items:[],items2:[]}},props:{visible:{type:Boolean,required:!0}},methods:{resize:function(){this.gridHeight=lt.gridHeight()},open:function(t){var e={Control:d["default"],Params:t.iddeclare,SQLParams:null,data:{}},n=t.id;null==ot.get(n)&&(ot.set(n,e),st.push(n)),lt.current=n,window.location.hash=n}},mounted:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e,n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=ot.get("-1"),e.resize=this.resize,n="React/Banner",t.next=5,lt.fetch(n,null);case 5:a=t.sent,Array.prototype.push.apply(this.items,a.items),Array.prototype.push.apply(this.items2,a.items2),lt.testApi="OK"==a.Error,this.loading=!1;case 10:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},u=l,p=n("2877"),h=n("6544"),f=n.n(h),m=n("40dc"),v=n("5bc1"),b=n("b0af"),g=n("132d"),w=n("8860"),y=n("da13"),k=n("5d23"),D=n("1baa"),x=n("f6c4"),F=n("2fa4"),_=n("2a7f"),S=Object(p["a"])(u,s,c,!1,null,null,null),R=S.exports;f()(S,{VAppBar:m["a"],VAppBarNavIcon:v["a"],VCard:b["a"],VIcon:g["a"],VList:w["a"],VListItem:y["a"],VListItemContent:k["a"],VListItemGroup:D["a"],VListItemTitle:k["b"],VMain:x["a"],VSpacer:F["a"],VToolbarTitle:_["a"]});var O=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-fragment",[n("v-dialog",{attrs:{persistent:""},model:{value:t.openEditor,callback:function(e){t.openEditor=e},expression:"openEditor"}},[n("v-card",[n("v-card-title",[t._v("Редактор колонок")]),n("div",{staticStyle:{height:"60vh",maxheight:"60vh",overflow:"auto"}},[n("v-simple-table",{attrs:{dense:"",light:""},scopedSlots:t._u([{key:"default",fn:function(){return[n("tbody",t._l(t.columns,(function(e,a){return n("tr",{key:a,staticStyle:{"background-color":"white"}},[n("td",{staticStyle:{"border-bottom":"none",width:"15px"}},[n("v-checkbox",{model:{value:e.visible,callback:function(n){t.$set(e,"visible",n)},expression:"column.visible"}})],1),n("td",{staticStyle:{"border-bottom":"none",width:"100px"}},[n("v-text-field",{attrs:{label:"№"},model:{value:e.ord,callback:function(n){t.$set(e,"ord",n)},expression:"column.ord"}})],1),n("td",{staticStyle:{"border-bottom":"none"}},[n("v-text-field",{attrs:{label:e.fieldname},model:{value:e.fieldcaption,callback:function(n){t.$set(e,"fieldcaption",n)},expression:"column.fieldcaption"}})],1),n("td",{staticStyle:{"border-bottom":"none"}},[n("v-text-field",{attrs:{label:"Формат"},model:{value:e.displayformat,callback:function(n){t.$set(e,"displayformat",n)},expression:"column.displayformat"}})],1)])})),0)]},proxy:!0}])})],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(e){return t.SaveColumn()}}},[t._v("ОК")]),n("v-btn",{attrs:{color:"red darken-1",text:""},on:{click:function(e){return t.setEditor(!1)}}},[t._v("Отмена")])],1)],1)],1),n("Finder",{ref:"columnEdit",attrs:{id:t.id,visible:t.visible,params:t.params}},[[n("v-btn",{attrs:{icon:"",title:"Просмотр данных"},on:{click:function(e){return t.open()}}},[n("v-icon",[t._v("mdi-database-search")])],1),n("v-btn",{attrs:{icon:"",title:"Редактор колонок"},on:{click:function(e){return t.beginEdit()}}},[n("v-icon",[t._v("mdi-cog")])],1),n("v-btn",{attrs:{icon:"",title:"Очистить настройки колонок"},on:{click:function(e){return t.del()}}},[n("v-icon",[t._v("mdi-autorenew")])],1),n("v-divider",{staticClass:"mx-4",attrs:{vertical:""}})]],2)],1)},C=[],j=(n("d81d"),{name:"Declare",data:function(){return{openEditor:!1,columns:[{FieldName:"aaa"},{FieldName:"bbb"}]}},props:{visible:{type:Boolean,required:!0},id:String,params:String},components:{Finder:d["default"]},methods:{setEditor:function(t){this.openEditor=t},beginEdit:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e,n,a,i,r,o=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=ot.get(this.id).data.curRow,!(e<0||e>ot.get(this.id).data.MainTab.length-1)){t.next=3;break}return t.abrupt("return");case 3:return n=ot.get(this.id).data.MainTab[e]["iddeclare"].toString(),a=it+"React/GetColumn?id="+n,t.next=7,fetch(a,{method:"GET",mode:at?"no-cors":"cors",cache:"no-cache",credentials:at?"include":"omit"});case 7:return i=t.sent,t.next=10,i.json();case 10:if(r=t.sent,!r.Error){t.next=14;break}return lt.alert("Колонки таблиц",r.Error),t.abrupt("return");case 14:this.columns=[],r.map((function(t){return o.columns.push(t)})),this.setEditor(!0);case 17:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),SaveColumn:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e,n,a,i,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=ot.get(this.id).data.curRow,!(e<0||e>ot.get(this.id).data.MainTab.length-1)){t.next=3;break}return t.abrupt("return");case 3:return n=ot.get(this.id).data.MainTab[e]["iddeclare"].toString(),a=it+"React/SaveColumnA",i=new FormData,i.append("id",n),i.append("columns",JSON.stringify(this.columns)),t.next=10,fetch(a,{method:"POST",body:i,mode:at?"no-cors":"cors",cache:"no-cache",credentials:at?"include":"omit"});case 10:return r=t.sent,t.next=13,r.json();case 13:o=t.sent,o.Error&&lt.alert("Колонки таблиц",o.Error),this.setEditor(!1);case 16:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),open:function(){var t=ot.get(this.id).data.curRow;if(!(t<0||t>ot.get(this.id).data.MainTab.length-1)){var e=ot.get(this.id).data.MainTab[t],n=e["iddeclare"].toString(),a=this.id+"_query_"+e["iddeclare"].toString();lt.openFinder(n,a,d["default"])}},del:function(){var t=ot.get(this.id).data.curRow;if(!(t<0||t>ot.get(this.id).data.MainTab.length-1)){var e=ot.get(this.id).data.MainTab[t]["iddeclare"];null==e&&(e=ot.get(this.id).data.MainTab[t]["IdDeclare"]);var n=e.toString(),a=it+"React/ClearColumn?id="+n;fetch(a,{method:"GET"}).then((function(t){return t.json()})).then((function(t){lt.alert("Колонки таблиц",t.Error)}))}},update:function(){var t=ot.get(this.id).data.curRow;if(!(t<0||t>ot.get(this.id).data.MainTab.length-1)){var e=ot.get(this.id).data.MainTab[t]["iddeclare"].toString(),n=it+"React/UpdateColumn?id="+e;fetch(n,{method:"GET"}).then((function(t){return t.json()})).then((function(t){lt.alert("Колонки таблиц",t.Error)}))}},save:function(){var t=ot.get(this.id).data.curRow;if(!(t<0||t>ot.get(this.id).data.MainTab.length-1)){var e=ot.get(this.id).data.MainTab[t]["iddeclare"].toString(),n=it+"React/SaveColumn?id="+e;fetch(n,{method:"GET"}).then((function(t){return t.json()})).then((function(t){lt.alert("Колонки таблиц",t.Error)}))}}}}),T=j,M=n("8336"),E=n("99d9"),P=n("ac7c"),V=n("169a"),L=n("ce7e"),N=n("1f4f"),A=n("8654"),W=Object(p["a"])(T,O,C,!1,null,null,null),I=W.exports;f()(W,{VBtn:M["a"],VCard:b["a"],VCardActions:E["a"],VCardTitle:E["c"],VCheckbox:P["a"],VDialog:V["a"],VDivider:L["a"],VIcon:g["a"],VSimpleTable:N["a"],VSpacer:F["a"],VTextField:A["a"]});var $=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Finder",{ref:"mftquery",attrs:{id:t.id,visible:t.visible,params:t.params}},[[n("v-tooltip",{attrs:{left:""},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,i=e.attrs;return[n("v-btn",t._g(t._b({attrs:{icon:""},on:{click:function(e){return t.open()}}},"v-btn",i,!1),a),[n("v-icon",[t._v("mdi-pencil")])],1)]}}])},[n("span",[t._v("Редактировать данные НСИ")])])]],2)},K=[],B={name:"MftQuery",data:function(){return{}},props:{visible:{type:Boolean,required:!0},id:String,params:String},components:{Finder:d["default"]},methods:{open:function(){var t=ot.get(this.id).data.curRow;if(!(t<0||t>ot.get(this.id).data.MainTab.length-1)){var e=ot.get(this.id).data.MainTab[t],n=e["iddeclare"].toString(),a=this.id+"_query_"+e["iddeclare"].toString();lt.openFinder(n,a,d["default"])}}}},Q=B,z=n("3a2f"),U=Object(p["a"])(Q,$,K,!1,null,null,null),H=U.exports;f()(U,{VBtn:M["a"],VIcon:g["a"],VTooltip:z["a"]});var G={name:"App",data:function(){return{openIDs:st,mainObj:lt,loading:!0,treejson:[],hoverable:!1,openOnClick:!0}},methods:{back:function(){lt.curhistory>0&&(lt.curhistory=lt.curhistory-1,lt.drawer=!1,lt.current=lt.history[lt.curhistory])},next:function(){lt.curhistory<lt.history.length-1&&(lt.curhistory=lt.curhistory+1,lt.drawer=!1,lt.current=lt.history[lt.curhistory])},exit:function(){window.location=it+"Home/logout"},handleselect:function(t){if(!t.children){var e=t.attributes.link1;if(e){if("/"==e.substring(0,1))return e=it+e,this.$refs.openFileLink.href=e,void this.$refs.openFileLink.click();if("exit"==e)return void(window.location=it+"Home/logout");if("test_api"==e)return void lt.alert("Тест API","Test OK !")}this.open(t),lt.drawer=!1}},handleClose:function(){lt.openAlert=!1,lt.alertConfirm&&lt.confirmAction()},open:function(t){var e=t.id;if(null==ot.get(e)){var n=this.getForm(t),a={Control:n.Conrol,Params:n.Params,SQLParams:n.SQLParams,data:{}};ot.set(e,a),st.push(e)}lt.current=e,window.location.hash=e},getForm:function(t){var e=t.attributes,n=e.params?d["default"]:R,a=e.params,i=null;return"Declare"==e.link1&&(n=I),"mftquery"==e.link1&&(n=H),{Conrol:n,Params:a,SQLParams:i}}},mounted:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e,n,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=document.getElementsByTagName("html")[0],e.style.overflowY="hidden",n=it+"ustore/gettree",t.next=5,fetch(n,{method:"POST",mode:at?"no-cors":"cors",cache:"no-cache",credentials:at?"include":"omit"});case 5:return a=t.sent,t.next=8,a.json();case 8:i=t.sent,this.treejson=i,this.loading=!1;case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},J=G,q=n("7496"),Y=n("f774"),X=n("eb2a"),Z=Object(p["a"])(J,r,o,!1,null,null,null),tt=Z.exports;f()(Z,{VApp:q["a"],VBtn:M["a"],VCard:b["a"],VCardActions:E["a"],VCardText:E["b"],VCardTitle:E["c"],VDialog:V["a"],VNavigationDrawer:Y["a"],VSpacer:F["a"],VTreeview:X["a"]});n("5363");var et=n("f309");i["a"].use(et["a"]);var nt=new et["a"]({theme:{},icons:{iconfont:"mdi"}});i["a"].config.productionTip=!0;var at=!0,it=at?"":" http://localhost:5000/",rt=-1,ot=new Map,st=[];function ct(){return dt.apply(this,arguments)}function dt(){return dt=Object(a["a"])(regeneratorRuntime.mark((function t(){var e,n,a,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e="React/Banner",e=it+e,t.next=4,fetch(e,{method:"POST",mode:at?"no-cors":"cors",cache:"no-cache",credentials:at?"include":"omit"});case 4:return n=t.sent,t.next=7,n.json();case 7:a=t.sent,lt.testApi="OK"==a.Error,lt.admin=a.Admin,rt="108",i="168",r=I,a.Admin&&(rt="109",i="169",r=d["default"]),ot.set(rt,{Control:r,Params:i,SQLParams:null,data:{}}),st.push(rt),window.location.hash=rt;case 17:case"end":return t.stop()}}),t)}))),dt.apply(this,arguments)}ct();var lt={message:"__",drawer:!1,current:rt,openAlert:!1,alert:function(t,e){this.alertConfirm=!1,this.alertTitle=t,this.alertText=e,this.openAlert=!0},confirm:function(t,e,n){this.alertConfirm=!0,this.alertTitle=t,this.alertText=e,this.confirmAction=n,this.openAlert=!0},history:[rt],curhistory:0,gridHeight:function(){return document.documentElement.clientHeight-68},selectedColor:"LightGreen",testApi:!1,admin:!1,dateformat:function(t,e){if(!t)return t;if("text"==e||"hide"==e||"password"==e||"disabled"==e)return t;if(t.length<19){var n=e.match(/0\.(0+)/),a=0;return n&&n.length>1&&(a=n[1].length),a>0?Number(t.toString()).toFixed(a):t}return e=e.replace("yyyy",t.substr(0,4)),e=e.replace("yy",t.substr(2,2)),e=e.replace("MM",t.substr(5,2)),e=e.replace("dd",t.substr(8,2)),e=e.replace("HH",t.substr(11,2)),e=e.replace("mm",t.substr(14,2)),e},resize:function(){ot.forEach((function(t){t.resize&&t.resize()}))},enterKeyDown:function(t){var e=ot.get(lt.current);e&&e.enterKeyDown&&e.enterKeyDown(t)},extupdate:function(t,e){ot.forEach((function(n){n.extupdate&&n.extupdate(t,e)}))},openFinder:function(t,e,n){var a={Control:n,Params:t,SQLParams:null,data:{}};null!=ot.get(e)&&ot.delete(e),ot.set(e,a),st.push(e),lt.current=e,window.location.hash=e},fetch:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e,n){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=it+e,t.next=3,fetch(e,{method:"POST",mode:at?"no-cors":"cors",cache:"no-cache",credentials:at?"include":"omit",body:n});case 3:return a=t.sent,t.next=6,a.json();case 6:return i=t.sent,t.abrupt("return",i);case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())};window.addEventListener("resize",(function(){lt.resize&&lt.resize()}),!0),window.addEventListener("popstate",(function(){var t=window.location.hash.replace("#","");t!=lt.current&&st.includes(t)&&(lt.current=t)}),!1),document.body.addEventListener("keydown",lt.enterKeyDown,!0),i["a"].component("uni-comp",{data:function(){return{openMap:ot,mainObj:lt}},props:{id:{type:String,required:!0}},render:function(t){var e=ot.get(this.id).Control,n=ot.get(this.id).Params,a=lt.current==this.id;return t(e,{props:{id:this.id,params:n,visible:a}})}}),new i["a"]({vuetify:nt,render:function(t){return t(tt)}}).$mount("#app")},"639d":function(t,e,n){},f397:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{height:"100vh",maxheight:"100vh",overflow:"auto"},attrs:{hidden:!t.visible}},[n("v-dialog",{attrs:{persistent:""},model:{value:t.openFilter,callback:function(e){t.openFilter=e},expression:"openFilter"}},[n("v-card",[n("v-card-title",[t._v("Фильтровка и сортировка")]),n("div",{staticStyle:{height:"60vh",maxheight:"60vh",overflow:"auto"}},[t.load?t._e():n("v-simple-table",{attrs:{dense:"",light:"",tabindex:"0"},scopedSlots:t._u([{key:"default",fn:function(){return[n("tbody",t._l(t.OpenMapData().Fcols,(function(e,a){return n("tr",{key:e.FieldName,staticStyle:{"background-color":"white"}},[n("td",{staticStyle:{"border-bottom":"none"}},[n("v-text-field",{attrs:{label:e.FieldCaption,"append-icon":t.getIcon(e)},on:{"click:append":function(n){return t.sortChangeIndex(e,a)}},model:{value:e.FindString,callback:function(n){t.$set(e,"FindString",n)},expression:"column.FindString"}})],1),n("td",{staticStyle:{"border-bottom":"none",width:"50px"}},[t._v(" "+t._s(e.SortOrder)+" "),n("span",{attrs:{hidden:""}},[t._v(t._s(t.rangSort))]),n("span",{attrs:{hidden:""}},[t._v(t._s(t.nactord))])])])})),0)]},proxy:!0}],null,!1,283315501)})],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(e){return t.updateTab()}}},[t._v("ОК")]),n("v-btn",{attrs:{color:"red darken-1",text:""},on:{click:function(e){return t.setFilter(!1)}}},[t._v("Отмена")])],1)],1)],1),n("div",{staticStyle:{height:"100vh",maxheight:"100vh",overflow:"auto"},attrs:{hidden:"grid"!=t.mode}},[t.stateDrawer?t._e():n("v-app-bar",{attrs:{app:"","max-width":"100vw",height:"65",dark:t.mainObj.admin,color:t.mainObj.admin?"primary":"white"}},[null==t.editid&&-1==t.id.indexOf("_")?n("v-app-bar-nav-icon",{on:{click:function(e){t.mainObj.drawer=!t.mainObj.drawer}}}):t._e(),null==t.editid&&t.id.indexOf("_")>-1?n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.back()}}},[n("v-icon",{attrs:{title:"Закрыть"}},[t._v("mdi-window-close")])],1):t._e(),n("v-toolbar-title",[t._v(t._s(t.Descr))]),n("v-spacer"),n("v-spacer"),n("v-spacer"),n("v-divider",{staticClass:"mx-4",attrs:{vertical:""}}),null!=t.editid||t.load?t._e():[t.OpenMapData().DelProc?n("v-btn",{key:"6",attrs:{icon:""},on:{click:function(e){return t.add()}}},[n("v-icon",{attrs:{title:"Добавить"}},[t._v("mdi-plus")])],1):t._e(),t.OpenMapData().EditProc?n("v-btn",{key:"7",attrs:{icon:""},on:{click:function(e){return t.edit()}}},[n("v-icon",{attrs:{title:"Редактировать"}},[t._v("mdi-pencil")])],1):t._e(),t.OpenMapData().DelProc?n("v-btn",{key:"8",attrs:{icon:""},on:{click:function(e){return t.confirmDelete()}}},[n("v-icon",{attrs:{title:"Удалить"}},[t._v("mdi-delete")])],1):t._e()],t.load?t._e():n("v-btn",{key:"1",attrs:{icon:""},on:{click:function(e){return t.setFilter(!0)}}},[n("v-icon",{attrs:{title:"Фильтровка и сортировка"}},[t._v("mdi-filter-menu")])],1),null!=t.editid||t.load?t._e():[n("v-btn",{key:"3",attrs:{icon:""},on:{click:function(e){return t.csv()}}},[n("v-icon",{attrs:{title:"Экспорт в CSV"}},[t._v("mdi-cloud-download")])],1),t.OpenMapData().KeyValue?n("v-btn",{key:"4",attrs:{icon:""},on:{click:function(e){return t.openDetail()}}},[n("v-icon",{attrs:{title:"Детали"}},[t._v("mdi-details")])],1):t._e(),t.OpenMapData().IdDeclareSet&&!t.load?n("v-btn",{key:"5",attrs:{icon:""},on:{click:function(e){return t.editSetting()}}},[n("v-icon",{attrs:{title:"Параметры"}},[t._v("mdi-cog")])],1):t._e()],n("v-divider",{staticClass:"mx-4",attrs:{vertical:""}}),t._t("default"),t.searchFocus?t._e():n("v-btn",{key:"18",attrs:{icon:""},on:{click:function(e){return t.setSearchFocus()}}},[n("v-icon",{attrs:{title:"Поиск"}},[t._v("mdi-magnify")])],1),!t.load&&t.searchFocus?n("v-text-field",{ref:"search",attrs:{label:"Поиск",dense:"",filled:"",rounded:"","hide-details":"","prepend-inner-icon":"mdi-magnify","single-line":""},on:{input:function(e){return t.updateTab()},blur:function(e){return t.exitSearch()}},model:{value:t.OpenMapData().SearchCols[0].FindString,callback:function(e){t.$set(t.OpenMapData().SearchCols[0],"FindString",e)},expression:"OpenMapData().SearchCols[0].FindString"}}):t._e(),n("v-divider",{staticClass:"mx-4",attrs:{vertical:""}}),null!=t.editid?[n("v-btn",{attrs:{icon:"",title:"Выбрать"},on:{click:function(e){return t.selectFinder(t.editid)}}},[n("v-icon",[t._v("mdi-check")])],1),n("v-btn",{attrs:{icon:"",title:"Отмена"},on:{click:function(e){return t.clearFinder()}}},[n("v-icon",[t._v("mdi-window-close")])],1)]:[t.mainObj.testApi?n("v-icon",{attrs:{title:"API НСИ доступно",color:"green darken-1"}},[t._v("mdi-wifi")]):t._e(),t.mainObj.testApi?t._e():n("v-icon",{attrs:{title:"API НСИ недоступно",color:"red darken-1"}},[t._v("mdi-wifi-off")])]],2),n("v-main",[t.load?t._e():[t._t("table",[t.load?t._e():n("v-simple-table",{attrs:{dense:"","fixed-header":"",height:t.gridHeight},scopedSlots:t._u([{key:"default",fn:function(){return[n("thead",[n("tr",[t._l(t.OpenMapData().Fcols,(function(e){return["text"!=e.DisplayFormat&&"hide"!=e.DisplayFormat&&"password"!=e.DisplayFormat?n("th",{key:e.FieldName,staticStyle:{"background-color":"LightGrey"}},[n("br"),t._v(t._s(e.FieldCaption))]):t._e()]}))],2)]),t.nupdate>0?n("tbody",{ref:"mainGrid",attrs:{tabindex:"-1"},on:{keydown:t.enterKeyDownLocal}},t._l(t.OpenMapData().MainTab,(function(e,a){return n("tr",{key:a,style:{"background-color":a==t.current?t.selectedColor:"white"},on:{click:function(e){return t.handleClick(a)}}},[t._l(t.OpenMapData().Fcols,(function(a){return["text"!=a.DisplayFormat&&"hide"!=a.DisplayFormat&&"password"!=a.DisplayFormat?n("td",{key:a.FieldName},[t._v(" "+t._s(""==a.DisplayFormat?e[a.FieldName]:t.dateformat(e[a.FieldName],a.DisplayFormat)))]):t._e()]}))],2)})),0):t._e(),t.OpenMapData().TotalTab&&t.OpenMapData().TotalTab[0]&&t.OpenMapData().nrows<t.OpenMapData().TotalTab[0].n_total?n("tfoot",[n("tr",[n("td",{attrs:{colspan:"100"}},[n("Pagination",{attrs:{findData:t.OpenMapData(),par:t.onChangePage,action:t.action}})],1)])]):t._e()]},proxy:!0}],null,!1,4076505856)})])]],2)],1),n("div",{staticStyle:{height:"100vh",maxheight:"100vh",overflow:"auto"},attrs:{hidden:!("edit"==t.mode||"add"==t.mode)}},[null!=t.editid||t.load?t._e():n("Editor",{attrs:{save:t.save,closeEditor:t.closeEditor,action:t.mode,findData:t.OpenMapData(),uid:t.uid,readonly:!t.OpenMapData().EditProc}},[t._t("editor")],2)],1),n("div",{staticStyle:{height:"100vh",maxheight:"100vh",overflow:"auto"},attrs:{hidden:!("setting"==t.mode)}},[t.OpenMapData().IdDeclareSet&&!t.load?n("Editor",{attrs:{save:t.saveSetting,closeEditor:t.closeEditor,action:t.mode,findData:t.OpenMapData().Setting,uid:t.uid2}}):t._e()],1)],1)},i=[],r=(n("99af"),n("4de4"),n("caad"),n("c975"),n("a15b"),n("d81d"),n("a434"),n("a9e3"),n("d3b7"),n("ac1f"),n("25f0"),n("2532"),n("3ca3"),n("841c"),n("1276"),n("ddb0"),n("2b3d"),n("96cf"),n("1da1")),o=n("56d7"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-toolbar",{attrs:{dense:"",flat:"",width:"100vw"}},[n("span",{attrs:{hidden:""}},[t._v(t._s(t.action))]),n("v-spacer"),n("v-btn",{staticClass:"mx-2",attrs:{small:"",disabled:0===t.page()},on:{click:function(e){return t.onChangePage(0)}}},[n("v-icon",[t._v("mdi-page-first")])],1),n("v-btn",{staticClass:"mx-2",attrs:{small:"",disabled:0===t.page()},on:{click:function(e){t.onChangePage(t.page()-1)}}},[n("v-icon",[t._v("mdi-chevron-left")])],1),n("span",{staticClass:"mx-2",attrs:{small:""}},[t._v(" "+t._s(t.page()+1)+" из "+t._s(Math.max(0,Math.ceil(t.count()/t.nrows())-1)+1)+" ")]),n("v-btn",{staticClass:"mx-2",attrs:{small:"",disabled:t.page()>=Math.ceil(t.count()/t.nrows())-1},on:{click:function(e){t.onChangePage(t.page()+1)}}},[n("v-icon",[t._v("mdi-chevron-right")])],1),n("v-btn",{staticClass:"mx-2",attrs:{small:"",disabled:t.page()>=Math.ceil(t.count()/t.nrows())-1},on:{click:function(e){t.onChangePage(Math.max(0,Math.ceil(t.count()/t.nrows())-1))}}},[n("v-icon",[t._v("mdi-page-last")])],1),n("v-spacer")],1)},c=[],d={name:"Pagination",data:function(){return{rowsPerPage:30}},props:{findData:Object,par:Function,action:Object},methods:{onChangePage:function(t){this.par(t)},OpenMapData:function(){return this.findData},count:function(){return this.OpenMapData().TotalTab?this.OpenMapData().TotalTab[0].n_total:0},page:function(){return this.OpenMapData().page?this.OpenMapData().page-1:0},nrows:function(){return this.OpenMapData().nrows?this.OpenMapData().nrows:30}}},l=d,u=n("2877"),p=n("6544"),h=n.n(p),f=n("8336"),m=n("132d"),v=n("2fa4"),b=n("71d9"),g=Object(u["a"])(l,s,c,!1,null,null,null),w=g.exports;h()(g,{VBtn:f["a"],VIcon:m["a"],VSpacer:v["a"],VToolbar:b["a"]});var y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{height:"100vh",maxheight:"100vh",overflow:"auto"}},[n("div",{staticStyle:{height:"100vh",maxheight:"100vh",overflow:"auto"},attrs:{hidden:"edit"!=t.mode}},[n("v-app-bar",{attrs:{app:"","max-width":"100vw"}},[(t.action,t._e()),n("v-toolbar-title",[t._v(t._s(t.Descr()))]),n("v-spacer"),!t.readonly&&t.findData.AddKeys?n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.addfile()}}},[n("v-icon",{attrs:{title:"Добавить файл"}},[t._v("mdi-paperclip")])],1):t._e(),t.readonly?t._e():n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.save()}}},[n("v-icon",{attrs:{title:"Сохранить"}},[t._v("mdi-check")])],1),n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.closeEditor()}}},[n("v-icon",{attrs:{title:"Отменить"}},[t._v("mdi-window-close")])],1)],1),n("v-main",[t._t("default",[n("v-simple-table",{scopedSlots:t._u([{key:"default",fn:function(){return[t.nupdate>0&&""!=t.uid?n("tbody",[t.readonly?t._l(t.findData.Fcols,(function(e,a){return n("tr",{key:a,staticStyle:{"background-color":"white"}},[n("td",{staticStyle:{"border-bottom":"none"}},[n("v-text-field",{key:e.FieldName+t.uid,attrs:{label:e.FieldCaption,value:t.findData.WorkRow[e.FieldName],readonly:""}})],1)])})):t._l(t.findData.ReferEdit.Editors,(function(e,a){return n("tr",{key:a,staticStyle:{"background-color":"white"}},[n("td",{staticStyle:{"border-bottom":"none"}},["password"==e.DisplayFormat&&t.nupdate>0?n("v-text-field",{key:e.FieldName+t.uid,attrs:{label:e.FieldCaption,"append-icon":e.show1?"mdi-eye":"mdi-eye-off",type:e.show1?"text":"password"},on:{"click:append":function(n){e.show1=!e.show1,t.nupdate++}},model:{value:t.findData.WorkRow[e.FieldName],callback:function(n){t.$set(t.findData.WorkRow,e.FieldName,n)},expression:"findData.WorkRow[column.FieldName]"}}):["text"==e.DisplayFormat?n("v-textarea",{key:e.FieldName+t.uid,attrs:{label:e.FieldCaption},model:{value:t.findData.WorkRow[e.FieldName],callback:function(n){t.$set(t.findData.WorkRow,e.FieldName,n)},expression:"findData.WorkRow[column.FieldName]"}}):[null==e.joinRow?n("v-text-field",{key:e.FieldName+t.uid,attrs:{label:e.FieldCaption,disabled:"disabled"==e.DisplayFormat},model:{value:t.findData.WorkRow[e.FieldName],callback:function(n){t.$set(t.findData.WorkRow,e.FieldName,n)},expression:"findData.WorkRow[column.FieldName]"}}):["CheckList"==e.joinRow.classname||"List"==e.joinRow.classname?n("v-text-field",{key:e.FieldName+t.uid,attrs:{label:e.FieldCaption},model:{value:t.findData.WorkRow[e.FieldName],callback:function(n){t.$set(t.findData.WorkRow,e.FieldName,n)},expression:"findData.WorkRow[column.FieldName]"}}):t._e(),"Bureau.Finder"==e.joinRow.classname?n("v-text-field",{key:e.FieldName+t.uid,attrs:{label:e.FieldCaption,"append-icon":"mdi-magnify",readonly:""},on:{"click:append":function(e){return t.open(a)}},model:{value:t.findData.WorkRow[e.FieldName],callback:function(n){t.$set(t.findData.WorkRow,e.FieldName,n)},expression:"findData.WorkRow[column.FieldName]"}}):t._e(),"Bureau.GridCombo"==e.joinRow.classname?n("v-select",{key:e.FieldName+t.uid,attrs:{label:e.FieldCaption,items:e.joinRow.FindConrol.MainTab,"item-value":e.joinRow.keyField,"item-text":e.joinRow.FindConrol.DispField},on:{change:function(n){return t.sortChange(n,e)}},model:{value:t.findData.WorkRow[e.joinRow.valField],callback:function(n){t.$set(t.findData.WorkRow,e.joinRow.valField,n)},expression:"findData.WorkRow[column.joinRow.valField]"}}):t._e()]]]],2)])}))],2):t._e()]},proxy:!0}])}),!t.readonly&&t.findData.AddKeys?n("FileList",{attrs:{findData:t.findData}}):t._e(),t.readonly?t._e():[t._l(t.findData.ReferEdit.Editors,(function(e,a){return[null==e.joinRow||"CheckList"!=e.joinRow.classname&&"List"!=e.joinRow.classname?t._e():[n("span",{key:a,staticStyle:{"margin-left":"15px"}},[t._v(t._s(e.joinRow.FindConrol.Descr)+":")]),n("v-simple-table",{key:a,attrs:{dense:""},scopedSlots:t._u([{key:"default",fn:function(){return[n("thead",[n("tr",{attrs:{dence:""}},["CheckList"==e.joinRow.classname?n("th",{staticStyle:{"background-color":"LightGrey"}},[t._v(" Доступ ")]):t._e(),t._l(e.joinRow.FindConrol.Fcols,(function(e){return n("th",{key:e.FieldName,staticStyle:{"background-color":"LightGrey"}},[t._v(t._s(e.FieldCaption))])}))],2)]),t.nupdate>0&&""!=t.uid?n("tbody",[t._l(e.joinRow.FindConrol.MainTab,(function(a,i){return["CheckList"==e.joinRow.classname||a.check?n("tr",{key:i,staticStyle:{"border-bottom":"none"},attrs:{dense:""}},["CheckList"==e.joinRow.classname?n("td",{attrs:{dense:""}},[n("v-checkbox",{model:{value:a.check,callback:function(e){t.$set(a,"check",e)},expression:"row.check"}})],1):t._e(),t._l(e.joinRow.FindConrol.Fcols,(function(e){return n("td",{key:e.FieldName,attrs:{dense:""}},[t._v(t._s(a[e.FieldName]))])}))],2):t._e()]}))],2):t._e()]},proxy:!0}],null,!0)})]]}))]])],2)],1),t.readonly?t._e():[t._l(t.findData.ReferEdit.Editors,(function(e,a){return[null!=e.joinRow?["Bureau.Finder"==e.joinRow.classname||"CheckList"==e.joinRow.classname||"List"==e.joinRow.classname?n("Finder",{key:a,attrs:{visible:t.mode=="finder_"+a.toString(),params:e.joinRow.IdDeclare,editid:a,findData:e.joinRow.FindConrol,selectFinder:t.selectFinder,clearFinder:t.clearFinder}}):t._e()]:t._e()]}))]],2)},k=[],D=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-list",[n("v-list-item",[n("v-list-item-icon",["Загружен"==t.status?n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.download()}}},[n("v-icon",{attrs:{title:"Скачать файл"}},[t._v("mdi-download")])],1):t._e(),"Нет"!=t.status?n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.del()}}},[n("v-icon",{attrs:{title:"Удалить файл"}},[t._v("mdi-delete")])],1):t._e()],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Файл: "+t._s(t.status))]),n("input",{ref:"fileUploadElem",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:function(e){return t.handleFiles()}}}),n("a",{ref:"fileLink",attrs:{hidden:"",target:"_blank"}})],1)],1)],1)},x=[],F=(n("b0c0"),{name:"FileList",data:function(){return{status:String}},props:{findData:Object},computed:{},methods:{del:function(){this.findData.WorkRow[this.findData.AddKeys]=0,this.status="Нет"},download:function(){var t=this.findData.WorkRow[this.findData.AddKeys],e=o["baseUrl"]+"FileLoad/dnload?fh_pk="+t;this.$refs.fileLink.href=e,this.$refs.fileLink.click()},newfile:function(){this.$refs.fileUploadElem.click()},updatefilelist:function(){var t=this.findData.WorkRow[this.findData.AddKeys];this.status=t?"Загружен":"Нет"},handleFiles:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,n,a,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.$refs.fileUploadElem.files,e.length){t.next=3;break}return t.abrupt("return");case 3:return n=e[0],this.status=n.name,a="FileLoad/upload",i=new FormData,i.append("files",n),t.next=10,o["mainObj"].fetch(a,i);case 10:if(r=t.sent,this.$refs.fileUploadElem.value="",!r.Error){t.next=15;break}return o["mainObj"].alert("Загрузка файла",r.Error),t.abrupt("return");case 15:this.findData.WorkRow[this.findData.AddKeys]=r.fh_pk;case 16:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},mounted:function(){this.findData.newfile=this.newfile,this.findData.updatefilelist=this.updatefilelist}}),_=F,S=n("8860"),R=n("da13"),O=n("5d23"),C=n("34c3"),j=Object(u["a"])(_,D,x,!1,null,null,null),T=j.exports;h()(j,{VBtn:f["a"],VIcon:m["a"],VList:S["a"],VListItem:R["a"],VListItemContent:O["a"],VListItemIcon:C["a"],VListItemTitle:O["b"]});var M={name:"Editor",data:function(){return{mode:"edit",mainObj:o["mainObj"],nupdate:1}},props:{save:Function,closeEditor:Function,action:String,findData:Object,uid:String,readonly:Boolean},beforeCreate:function(){this.$options.components.Finder=n("f397").default},methods:{addfile:function(){this.findData.newfile()},Descr:function(){return"add"==this.action?"Новая запись ("+this.findData.Descr+")":"edit"==this.action?this.readonly?"Просмотр ("+this.findData.Descr+")":"Редактирование ("+this.findData.Descr+")":"setting"==this.action?"Параметры ("+this.findData.Descr+")":void 0},open:function(t){this.mode="finder_"+t.toString()},selectFinder:function(t){var e=this.findData.ReferEdit.Editors[t],n=this.findData.ReferEdit.Editors[t].joinRow.FindConrol.curRow,a=e.joinRow.FindConrol.MainTab[n];for(var i in e.joinRow.fields)this.findData.WorkRow[e.joinRow.fields[i]]=a[i];this.nupdate=this.nupdate+1,this.mode="edit"},sortChange:function(t,e){var n=this;e.joinRow.FindConrol.MainTab.map((function(a){if(a[e.joinRow.keyField]==t)for(var i in e.joinRow.fields)n.findData.WorkRow[e.joinRow.fields[i]]=a[i]})),this.nupdate=this.nupdate+1},clearFinder:function(){this.mode="edit"},textChange:function(t,e){this.findData.WorkRow[e]=t}},components:{FileList:T}},E=M,P=n("40dc"),V=n("5bc1"),L=n("ac7c"),N=n("f6c4"),A=n("b974"),W=n("1f4f"),I=n("8654"),$=n("a844"),K=n("2a7f"),B=Object(u["a"])(E,y,k,!1,null,null,null),Q=B.exports;h()(B,{VAppBar:P["a"],VAppBarNavIcon:V["a"],VBtn:f["a"],VCheckbox:L["a"],VIcon:m["a"],VMain:N["a"],VSelect:A["a"],VSimpleTable:W["a"],VSpacer:v["a"],VTextField:I["a"],VTextarea:$["a"],VToolbarTitle:K["a"]});var z={name:"Finder",components:{Pagination:w,Editor:Q},data:function(){return{mainObj:o["mainObj"],openMap:o["openMap"],load:!0,mode:"grid",Descr:"Загрузка...",current:0,stateDrawer:!1,action:1,nupdate:1,nactord:1,nadd:1,items:["Нет","ASC","DESC"],rangSort:0,uid:"zz",uid2:"yy",selectedColor:o["mainObj"].selectedColor,openFilter:!1,dispIndex:0,gridHeight:o["mainObj"].gridHeight(),searchFocus:!1}},props:{visible:{type:Boolean,required:!0},id:String,params:String,editid:Number,findData:Object,selectFinder:Function,clearFinder:Function},computed:{finderRowStyle:function(){}},methods:{back:function(){history.back()},resize:function(){this.gridHeight=o["mainObj"].gridHeight()},extupdate:function(t,e){if(null==this.id||e!=this.id){var n=this.OpenMapData();null!=n.ReferEdit&&n.ReferEdit.Editors.map((function(n){null!=n.joinRow&&null!=n.joinRow.FindConrol&&null!=n.joinRow.FindConrol.extupdate&&n.joinRow.FindConrol.extupdate(t,e)})),n.TableName==t&&this.updateTab()}},sortChange:function(t,e){var n=0,a=this.OpenMapData().Fcols;a.map((function(t,a){"Нет"==t.Sort&&(t.SortOrder=null),a!=e&&t.SortOrder&&t.SortOrder>n&&(n=t.SortOrder)})),a[e].SortOrder=n+1,this.rangSort=n+1,this.nactord=this.nactord+1},sortChangeIndex:function(t,e){"ASC"==t.Sort?t.Sort="DESC":"DESC"==t.Sort?t.Sort="Нет":t.Sort="ASC",this.sortChange(null,e)},getIcon:function(t){return"ASC"==t.Sort?"mdi-arrow-down":"DESC"==t.Sort?"mdi-arrow-up":"mdi-sort"},dateformat:function(t,e){return o["mainObj"].dateformat(t,e)},OpenMapData:function(){return null!=this.id?(null==o["openMap"].get(this.id)&&o["openMap"].set(this.id,{Control:null,Params:this.params,SQLParams:null,data:{}}),o["openMap"].get(this.id).data):this.findData},OpenMapId:function(){return null==o["openMap"].get(this.id)&&o["openMap"].set(this.id,{Control:null,Params:this.params,SQLParams:null,data:{}}),o["openMap"].get(this.id)},setLoad:function(t){this.load=t},setFilter:function(t){this.openFilter=t},setSearchFocus:function(){var t=this;this.searchFocus=!0,setTimeout((function(){t.$refs.search.$refs.input.focus()}),0)},exitSearch:function(){this.searchFocus=!1,this.$refs.mainGrid.focus()},enterKeyDownLocal:function(t){return null==this.editid||this.enterKeyDown(t)},enterKeyDown:function(t){if("grid"==this.mode){if(this.openFilter)return;"Enter"==t.code&&(this.searchFocus&&this.exitSearch(),this.handleClick(this.OpenMapData().curRow)),"ArrowDown"==t.code&&this.handleClick(this.OpenMapData().curRow+1),"ArrowUp"==t.code&&this.handleClick(this.OpenMapData().curRow-1),"PageDown"==t.code&&this.handleClick(this.OpenMapData().curRow+8),"PageUp"==t.code&&this.handleClick(this.OpenMapData().curRow-8),"Home"==t.code&&this.handleClick(0),"End"==t.code&&this.handleClick(this.OpenMapData().nrows)}else"Escape"==t.code&&this.closeEditor();return!0},handleClick:function(t){if(this.OpenMapData().curRow==t){if(t<0)return;this.current=t,null==this.editid?this.OpenMapData().EditProc?this.edit():this.OpenMapData().KeyValue?this.openDetail():this.edit():this.selectFinder(this.editid)}else{var e=this.OpenMapData(),n=e.MainTab.length;if(t<0&&(t=0),t>=n&&(t=n-1),t<0)return;e.curRow=t,this.current=t}},openDetail:function(){var t=this.OpenMapData();if(null!=t.curRow){var e,n,a,i=t.MainTab[t.curRow],r={};if(i["iddeclare"]&&i["keyf"]){var s=i["keyf"],c=i["dispfield"],d=i["iddeclare"];e=i[s],r[s]=e,n=d,a=i[c]}else e=i[t.KeyF],r[t.KeyF]=e,n=t.KeyValue,a=i[t.DispField];var l={Control:z,Params:n,TextParams:r,title:a,data:{}},u=this.id+"_"+i[t.KeyF];null==o["openMap"].get(u)&&(o["openMap"].set(u,l),o["openIDs"].push(u)),o["mainObj"].current=u,window.location.hash=u}},csv:function(){var t=o["baseUrl"]+"React/csv",e=new FormData,n=this.OpenMapData(),a=this.params;e.append("id",a),e.append("Fc",JSON.stringify(n.Fcols)),n.SQLParams&&e.append("SQLParams",JSON.stringify(n.SQLParams)),n.TextParams&&e.append("TextParams",JSON.stringify(n.TextParams)),fetch(t,{method:"POST",mode:o["prodaction"]?"no-cors":"cors",cache:"no-cache",credentials:o["prodaction"]?"include":"omit",body:e}).then((function(t){return t.blob()})).then((function(t){var e=document.createElement("a");e.href=URL.createObjectURL(t),e.setAttribute("download","data.csv"),e.click()}))},loadFile:function(){var t=this.OpenMapData();if(null!=t.curRow){var e=t.MainTab[t.curRow],n=this.params,a="F"+n+"_"+e[t.KeyF],i=t.Descr+", "+e[t.DispField],r=o["baseUrl"]+"Docfiles/dir?id="+a+"/&caption="+i;this.$refs.fileLink2.href=r,this.$refs.fileLink2.click()}},confirmDelete:function(){var t=this.OpenMapData();if(null!=t.curRow){var e=t.MainTab[t.curRow],n=e[t.DispField];n=null==n?"Удалить запись?":"Удалить запись '"+n+"'?",o["mainObj"].confirm(this.Descr,n,this.rowDelete)}},rowDelete:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,n,a,i,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.OpenMapData(),n={},n[e.KeyF]=e.MainTab[e.curRow][e.KeyF],e.DelProc.toLowerCase().indexOf("_del_1")>-1&&(n["AUDTUSER"]=e.Account),a=o["baseUrl"]+"React/exec",i=new FormData,i.append("EditProc",e.DelProc),i.append("SQLParams",JSON.stringify(n)),i.append("KeyF",e.KeyF),i.append("IdDeclare",this.params),i.append("mode","delete"),t.next=13,fetch(a,{method:"POST",mode:o["prodaction"]?"no-cors":"cors",cache:"no-cache",credentials:o["prodaction"]?"include":"omit",body:i});case 13:return r=t.sent,t.next=16,r.json();case 16:if(s=t.sent,"OK"==s.message||"Invalid storage type: DBNull."==s.message){t.next=20;break}return o["mainObj"].alert("Ошибка",s.message),t.abrupt("return");case 20:e.MainTab.splice(e.curRow,1),this.nupdate=this.nupdate+1,null!=o["openMap"].get(this.id).updateTab&&o["openMap"].get(this.id).updateTab(),o["mainObj"].extupdate(e.TableName,this.id);case 24:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),onChangePage:function(t){this.action=this.action+1,this.OpenMapData().page=t+1,this.updateTab()},updateTab:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,n,a,i,r,s,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=o["baseUrl"]+"React/FinderStart",n=new FormData,a=this.OpenMapData(),i=a.Fcols.concat(a.SearchCols),r=this.params,n.append("id",r),n.append("mode","data"),n.append("page",a.page.toString()),n.append("Fc",JSON.stringify(i)),a.SQLParams&&n.append("SQLParams",JSON.stringify(a.SQLParams)),a.TextParams&&n.append("TextParams",JSON.stringify(a.TextParams)),t.next=13,fetch(e,{method:"POST",mode:o["prodaction"]?"no-cors":"cors",cache:"no-cache",credentials:o["prodaction"]?"include":"omit",body:n});case 13:return s=t.sent,t.next=16,s.json();case 16:c=t.sent,c.Error?o["mainObj"].alert("Ошибка",c.Error):(a.MainTab=c.MainTab,a.TotalTab=c.TotalTab,a.page=c.page,this.mode,this.mode="grid",this.nupdate=this.nupdate+1,this.openFilter=!1,null!=o["openMap"].get(this.id).updateTab&&o["openMap"].get(this.id).updateTab());case 18:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),saveSetting:function(){var t=this.OpenMapData().Setting,e=t.MainTab[0];t.ColumnTab.map((function(n){e[n]=t.WorkRow[n]}));var n=this.OpenMapData();t.ReferEdit.SaveFieldList.map((function(e){n.SQLParams["@"+e]=t.MainTab[0][e]})),this.updateTab()},save:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,n,a,i,r,s,c,d,l,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(n in e=this.OpenMapData(),e.DefaultValues)e.WorkRow[n]=e.DefaultValues[n];for(a in e.TextParams)e.WorkRow[a]=e.TextParams[a];return this.postEdit(e),i={},e.ReferEdit.SaveFieldList.map((function(t){i[t]=e.WorkRow[t]})),r=o["baseUrl"]+"React/exec",s=new FormData,s.append("EditProc",e.EditProc),s.append("SQLParams",JSON.stringify(i)),s.append("KeyF",e.KeyF),s.append("IdDeclare",this.params),s.append("mode",this.mode),t.next=15,fetch(r,{method:"POST",mode:o["prodaction"]?"no-cors":"cors",cache:"no-cache",credentials:o["prodaction"]?"include":"omit",body:s});case 15:return c=t.sent,t.next=18,c.json();case 18:if(d=t.sent,"OK"==d.message){t.next=24;break}return o["mainObj"].alert("Ошибка",d.message),t.abrupt("return");case 24:1==d.ColumnTab.length?e.WorkRow[e.KeyF]=d.MainTab[0][d.ColumnTab[0]]:d.ColumnTab.map((function(t){e.WorkRow[t]=d.MainTab[0][t]}));case 25:l={},"edit"==this.mode&&(u=e.curRow,l=e.MainTab[u]),e.ColumnTab.map((function(t){l[t]=e.WorkRow[t]})),"add"==this.mode&&e.MainTab.push(l),this.mode="grid",this.nupdate=this.nupdate+1,null!=o["openMap"].get(this.id).updateTab&&o["openMap"].get(this.id).updateTab(),o["mainObj"].extupdate(e.TableName,this.id);case 33:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),closeEditor:function(){this.mode="grid"},add:function(){var t=this.OpenMapData();null==t.WorkRow&&(t.WorkRow={}),t.ColumnTab.map((function(e){t.WorkRow[e]=""})),this.initEdit(t),this.nadd=this.nadd+1,this.uid="uid"+this.nadd.toString(),this.mode="add"},initEdit:function(t){t.ReferEdit&&(t.updatefilelist&&t.updatefilelist(),t.ReferEdit.Editors.map((function(e){if("password"==e.DisplayFormat&&(e.show1=!1),null!=e.joinRow&&("CheckList"==e.joinRow.classname||"List"==e.joinRow.classname)){var n=e.joinRow.FindConrol.KeyF,a=e.joinRow.fields[n],i=t.WorkRow[a].split(",");e.joinRow.FindConrol.MainTab.map((function(t){t.check=i.includes(t[n])}))}})))},postEdit:function(t){t.ReferEdit&&t.ReferEdit.Editors.map((function(e){if(null!=e.joinRow&&"CheckList"==e.joinRow.classname){var n=e.joinRow.FindConrol.KeyF,a=e.joinRow.fields[n],i=[];e.joinRow.FindConrol.MainTab.filter((function(t){return t.check})).map((function(t){return i.push(t[n])})),t.WorkRow[a]=i.join()}}))},edit:function(){var t=this,e=this.OpenMapData();null==e.WorkRow&&(e.WorkRow={});var n=e.curRow,a=e.MainTab[n];e.ColumnTab.map((function(t){e.WorkRow[t]=null==a[t]?"":a[t]})),e.Fcols.map((function(n){""!=n.DisplayFormat&&(e.WorkRow[n.FieldName]=t.dateformat(e.WorkRow[n.FieldName],n.DisplayFormat))})),this.initEdit(e),this.nadd=this.nadd+1,this.uid="uid"+this.nadd.toString(),this.mode="edit"},editSetting:function(){var t=this,e=this.OpenMapData().Setting;e.WorkRow={};var n=e.MainTab[0];e.ColumnTab.map((function(t){e.WorkRow[t]=null==n[t]?"":n[t]})),e.Fcols.map((function(n){""!=n.DisplayFormat&&(e.WorkRow[n.FieldName]=t.dateformat(e.WorkRow[n.FieldName],n.DisplayFormat))})),this.nadd=this.nadd+1,this.uid2="uid2"+this.nadd.toString(),this.mode="setting"}},updated:function(){this.$refs.mainGrid&&this.$refs.mainGrid.focus()},mounted:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,n,a,i,r,s,c,d,l,u,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.OpenMapData,n=this.OpenMapId,a=this.setLoad,i=this.editid,r=this.params,null==i){t.next=14;break}return s=e(),s.curRow=0,this.Descr=s.Descr+" (выбор)",s.resize=this.resize,window.addEventListener("resize",(function(){s.resize&&s.resize()}),!0),s.extupdate=this.extupdate,a(!1),t.abrupt("return");case 14:return c=n(),c.handleClick=this.handleClick,c.resize=this.resize,c.extupdate=this.extupdate,c.enterKeyDown=this.enterKeyDown,d=o["baseUrl"]+"React/FinderStart",l=new FormData,l.append("id",r),c.SQLParams&&l.append("SQLParams",JSON.stringify(c.SQLParams)),c.TextParams&&l.append("TextParams",JSON.stringify(c.TextParams)),t.next=26,fetch(d,{method:"POST",mode:o["prodaction"]?"no-cors":"cors",cache:"no-cache",credentials:o["prodaction"]?"include":"omit",body:l});case 26:return u=t.sent,t.next=29,u.json();case 29:if(p=t.sent,!p.Error){t.next=33;break}return o["mainObj"].alert("Ошибка",p.Error),t.abrupt("return");case 33:p.curRow=0,p.WorkRow={},p.ColumnTab.map((function(t){p.WorkRow[t]=""})),c.data=p,this.Descr=p.Descr,c.title&&(this.Descr=this.Descr+" ("+c.title+")"),a(!1);case 40:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},U=z,H=U,G=(n("0417"),n("b0af")),J=n("99d9"),q=n("169a"),Y=n("ce7e"),X=Object(u["a"])(H,a,i,!1,null,"b187d3b6",null);e["default"]=X.exports;h()(X,{VAppBar:P["a"],VAppBarNavIcon:V["a"],VBtn:f["a"],VCard:G["a"],VCardActions:J["a"],VCardTitle:J["c"],VDialog:q["a"],VDivider:Y["a"],VIcon:m["a"],VMain:N["a"],VSimpleTable:W["a"],VSpacer:v["a"],VTextField:I["a"],VToolbarTitle:K["a"]})}});
//# sourceMappingURL=app.b0e1c6a5.js.map